Объект mailbox | Беспроводная передача сообщений
------------------------------------------------


Объект Mailbox позволяет реализовать беспроводную передачу данных между несколькими устройствами, поддерживающими данный протокол.
Передача данных осуществляется по WI-FI.

При запуске программы и необходимости передать некторое сообщение от первого устройства второму, первое устройство инициирует подключение
по известному IP-дресу устройства в WI-FI сети
специальной командой mailbox.connect, таким образом утройство регистрируется в сети "почтовых ящиков".

.. important:: После инициализации подключения, что со стороны Трик, что со стороны Пионер, для стабильной работы обязательно нужно ставить задержку (примерно 100мс), чтобы устройства успели обработать новые подключения.

У каждого устройства в сети для стабильной работы должен быть установлен уникальный бортовой номер, с помощью которых и происходит адресация
при отправке сообщений.

При инициировании подключения между устройствами происходит обмен данными об их бортовых номерах, а также об известных им подключениях.
То есть, если взять три контроллера К1, К2 и К3, инициировать подключение К2->К1, а затем К3->К1, то при подключении К3 к К1, К1 передаст данные
об известных ему подключениях, и К3 узнает о существовании К2, поэтому, при дальнейшей необходимости отправить сообщение с К3 на К2, инициализации подключения командой mailbox.connect производить не нужно.

.. function:: mailbox.connect(ip, port)

    Инициализация подключения к устройству с заданным адресом и портом

    :param ip: str - ip адрес устройства назначения
    :param port: num - порт устройства назначения, рекомендуется использовать 8889

    **Пример**

        .. code:: lua

            hull, message = mailbox.connect("192.168.0.100", 8889)


.. function:: mailbox.hasMessages()

    Проверяет, есть ли пришедшие сообщения

    :return: bool - есть ли пришедшие сообщения

    **Пример**

        .. code:: lua

            has_mes = mailbox.hasMessages()


.. function:: mailbox.myHullNumber()

    Возвращает текущий бортномер устройства

    :return: num - бортномер устройства

    **Пример**

        .. code:: lua

            my_hull = mailbox.myHullNumber()


.. function:: mailbox.receive(blocking)

    Считывание одного байта

    :param blocking: true|false - блокирование выполнения программы, при true ожидает получения сообщения, при false - возвращает сообщение из буфера или -1, если сообщений нет.
    :return: hull - бортномер отправителя, message - сообщение

    **Пример**

        .. code:: lua

            hull, message = mailbox.receive(true)


.. function:: mailbox.send(hull, message)

    Отправка сообщения

    :param hull: num - бортномер устройства, которому отправляется сообщение, если hull < 0, то сообщение отправится всем известным устроствам
    :param message: num|str - сообщение для отправки

    **Пример**

        .. code:: lua

            mailbox.send(42, "Hello Username")
            mailbox.send(-1, "Hello World")


.. function:: mailbox.setHullNumber(hull)

    Устанавливает новый бортномер для устройства, перезаписывается параметр Trik_hullNum

    :param hull: num - новый бортномер

    **Пример**

        .. code:: lua

            mailbox.setHullNumber(12)
